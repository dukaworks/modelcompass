generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Model {
  id            String   @id @default(cuid())
  modelId       String   @unique
  name          String
  provider      String
  description   String?
  capabilities  String[]
  contextLength Int
  maxTokens     Int?
  promptPrice     Float
  completionPrice Float
  tags            String[]
  recommendedFor  String[]
  codingScore     Int? @default(0)
  reasoningScore  Int? @default(0)
  writingScore    Int? @default(0)
  chineseScore    Int? @default(0)
  speedScore      Int? @default(0)
  websiteUrl    String?
  docsUrl       String?
  isActive      Boolean  @default(true)
  usageCount    Int      @default(0)
  ratingAvg     Float?   @default(0)
  ratingCount   Int      @default(0)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model UserSubmission {
  id          String   @id @default(cuid())
  modelId     String
  scenario    String
  rating      Int
  review      String?
  latencyMs   Int?
  costPer1k   Float?
  userEmail   String?
  userName    String?
  isApproved  Boolean  @default(false)
  createdAt   DateTime @default(now())
}

model ApiUsage {
  id          String   @id @default(cuid())
  modelId     String
  provider    String
  promptTokens     Int
  completionTokens Int
  totalTokens      Int
  costUsd     Float
  latencyMs   Int
  status      String
  createdAt   DateTime @default(now())
}

// 心跳任务日志
model HeartbeatLog {
  id          String   @id @default(cuid())
  taskName    String
  status      String   // success, failed, running
  error       String?
  duration    Int?     // 执行时间(毫秒)
  timestamp   DateTime @default(now())
  
  @@index([taskName])
  @@index([status])
  @@index([timestamp])
}

// Benchmark 评分表
model BenchmarkScore {
  id          String   @id @default(cuid())
  modelId     String
  mmlu        Float?
  humaneval   Float?
  gsm8k       Float?
  hellaswag   Float?
  source      String   // paperswithcode, huggingface, etc.
  url         String?  // 评测来源链接
  timestamp   DateTime @default(now())
  
  @@index([modelId])
  @@index([timestamp])
}

// 社交媒体指标
model SocialMetric {
  id              String   @id @default(cuid())
  modelId         String
  twitterMentions Int      @default(0)
  redditScore     Int      @default(0)
  githubStars     Int      @default(0)
  sentiment       Float?   // -1 到 1
  timestamp       DateTime @default(now())
  
  @@index([modelId])
  @@index([timestamp])
}